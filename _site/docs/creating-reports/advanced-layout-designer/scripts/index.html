<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Scripts - Horizon Reports</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Scripts | Horizon Reports</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Scripts" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Scripts allow you to specify code to execute for specific events during a report run. This can be used to display something different than the actual value of a field, to perform custom summarization, and other tasks. Horizon Reports uses scripts for report linking to tell the Preview window when a subreport should be displayed and what to do when the user clicks a hyperlinked field. Writing scripts requires knowledge of the C#, Visual Basic .NET, or JScript .NET languages so it’s intended for programmers only." /> <meta property="og:description" content="Scripts allow you to specify code to execute for specific events during a report run. This can be used to display something different than the actual value of a field, to perform custom summarization, and other tasks. Horizon Reports uses scripts for report linking to tell the Preview window when a subreport should be displayed and what to do when the user clicks a hyperlinked field. Writing scripts requires knowledge of the C#, Visual Basic .NET, or JScript .NET languages so it’s intended for programmers only." /> <link rel="canonical" href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/scripts/" /> <meta property="og:url" content="http://localhost:4000/docs/creating-reports/advanced-layout-designer/scripts/" /> <meta property="og:site_name" content="Horizon Reports" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2022-02-07T21:56:45-06:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Scripts" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"http://localhost:4000/docs/creating-reports/advanced-layout-designer/scripts/","headline":"Scripts","dateModified":"2022-02-07T21:56:45-06:00","datePublished":"2022-02-07T21:56:45-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/docs/creating-reports/advanced-layout-designer/scripts/"},"description":"Scripts allow you to specify code to execute for specific events during a report run. This can be used to display something different than the actual value of a field, to perform custom summarization, and other tasks. Horizon Reports uses scripts for report linking to tell the Preview window when a subreport should be displayed and what to do when the user clicks a hyperlinked field. Writing scripts requires knowledge of the C#, Visual Basic .NET, or JScript .NET languages so it’s intended for programmers only.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Horizon Reports </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/" class="nav-list-link">Home</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/whats-new/" class="nav-list-link">What's New in this Release</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/features/" class="nav-list-link">Features</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/logging-in/" class="nav-list-link">Logging In</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/licensing/" class="nav-list-link">Licensing</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/software-maintenance/" class="nav-list-link">Software Maintenance</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/technical-support/" class="nav-list-link">Technical Support</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/copyright/" class="nav-list-link">Copyright</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/index/" class="nav-list-link">Creating Reports</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/reports-explorer/" class="nav-list-link">The Reports Explorer</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/tags/" class="nav-list-link">Tags</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/previewing/" class="nav-list-link">Previewing a Report</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/exporting/" class="nav-list-link">Exporting a Report</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/quick-reports/index/" class="nav-list-link">Creating a Quick Report</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/quick-reports/step1/" class="nav-list-link">Step 1 Information</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/quick-reports/step2/" class="nav-list-link">Step 2 Data Selection</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/quick-reports/step3/" class="nav-list-link">Step 3 Grouping and Sorting</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/quick-reports/step4/" class="nav-list-link">Step 4 Filtering</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/quick-reports/step5/" class="nav-list-link">Step 5 Report Options</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/quick-reports/step6/" class="nav-list-link">Step 6 Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/cross-tab-reports/index/" class="nav-list-link">Creating a Cross-Tab Report</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/cross-tab-reports/step1/" class="nav-list-link">Step 1 Information</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/cross-tab-reports/step2/" class="nav-list-link">Step 2 Data Selection</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/cross-tab-reports/step3/" class="nav-list-link">Step 3 Grouping and Sorting</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/cross-tab-reports/step4/" class="nav-list-link">Step 4 Filtering</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/cross-tab-reports/step5/" class="nav-list-link">Step 5 Report Options</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/cross-tab-reports/step6/" class="nav-list-link">Step 6 Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/label-reports/index/" class="nav-list-link">Creating a Label Report</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/label-reports/step1/" class="nav-list-link">Step 1 Information</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/label-reports/step2/" class="nav-list-link">Step 2 Data Selection</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/label-reports/step3/" class="nav-list-link">Step 3 Grouping and Sorting</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/label-reports/step4/" class="nav-list-link">Step 4 Filtering</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/label-reports/step5/" class="nav-list-link">Step 5 Report Options</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/label-reports/step6/" class="nav-list-link">Step 6 Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/chart-reports/index/" class="nav-list-link">Creating a Chart Report</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/chart-reports/step1/" class="nav-list-link">Step 1 Information</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/chart-reports/step2/" class="nav-list-link">Step 2 Data Selection</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/chart-reports/step3/" class="nav-list-link">Step 3 Chart Layout</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/chart-reports/step4/" class="nav-list-link">Step 4 Filtering</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/chart-reports/step5/" class="nav-list-link">Step 5 Report Options</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/chart-reports/step6/" class="nav-list-link">Step 6 Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/dashboards/index/" class="nav-list-link">Creating a Dashboard</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/dashboards/step1/" class="nav-list-link">Step 1 Information</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/dashboards/step2/" class="nav-list-link">Step 2 Report Selection</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/dashboards/step3/" class="nav-list-link">Step 3 Dashboard Layout</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/dashboards/step4/" class="nav-list-link">Step 4 Security</a> </li></ul></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/sql-passthrough/" class="nav-list-link">SQL Passthrough</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/batch-reports/index/" class="nav-list-link">Creating a Batch Report</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/batch-reports/step1/" class="nav-list-link">Step 1 Information</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/batch-reports/step2/" class="nav-list-link">Step 2 Report Selection</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/batch-reports/step3/" class="nav-list-link">Step 3 Export Options</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/batch-reports/step4/" class="nav-list-link">Step 4 Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/filtering/index/" class="nav-list-link">Filtering</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/filtering/including-records/" class="nav-list-link">Selecting Records to Include</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/filtering/excluding-records/" class="nav-list-link">Selecting Which Records to Exclude</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/filtering/group-filters/" class="nav-list-link">Group Filtering</a> </li></ul></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/formatting-values/" class="nav-list-link">Formatting Values</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/subreports/" class="nav-list-link">Subreports</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/advanced-properties/" class="nav-list-link">Advanced Report Properties</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/formulas/" class="nav-list-link">Formulas</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/importing-and-exporting-reports/" class="nav-list-link">Importing and Exporting Reports</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/creating-reports/templates/" class="nav-list-link">Templates</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/index/" class="nav-list-link">Advanced Layout Designer</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/using-the-layout-designer/" class="nav-list-link">Using the Layout Designer</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/bands/" class="nav-list-link">Bands</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/report-objects/" class="nav-list-link">Report Objects</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/styles/" class="nav-list-link">Styles</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/formatting-rules/" class="nav-list-link">Formatting Rules</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/calculated-fields/" class="nav-list-link">Calculated Fields</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/parameters/" class="nav-list-link">Parameters</a> </li><li class="nav-list-item active"> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/scripts/" class="nav-list-link active">Scripts</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/expression-editor/" class="nav-list-link">Expression Editor</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/configuration/index/" class="nav-list-link">Configuration</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/configuration/" class="nav-list-link">Configuration Options</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/manage-licenses/" class="nav-list-link">Managing Licenses</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/managing-reports/" class="nav-list-link">Managing Reports</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/security/" class="nav-list-link">Security</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/scheduling/" class="nav-list-link">Scheduling Reports</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/setup-a-datasource/" class="nav-list-link">Setup Data Source</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/selecting-a-datasource/" class="nav-list-link">Selecting a Data Source</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/adding-a-logo/" class="nav-list-link">Adding a Logo to a Report</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/configuration/change-password/" class="nav-list-link">Changing your Password</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/reference/index/" class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/reference/usage/" class="nav-list-link">Reporting on Usage</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/reference/faq/" class="nav-list-link">Frequently Asked Questions</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/reference/function-reference/" class="nav-list-link">Expression and Function Reference</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/reference/support-package/" class="nav-list-link">Downloading Logs and Support Files</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Horizon Reports" aria-label="Search Horizon Reports" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/creating-reports/index/">Creating Reports</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/creating-reports/advanced-layout-designer/index/">Advanced Layout Designer</a></li> <li class="breadcrumb-nav-list-item"><span>Scripts</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p>Scripts allow you to specify code to execute for specific events during a report run. This can be used to display something different than the actual value of a field, to perform custom summarization, and other tasks. Horizon Reports uses scripts for report linking to tell the Preview window when a subreport should be displayed and what to do when the user clicks a hyperlinked field. Writing scripts requires knowledge of the C#, Visual Basic .NET, or JScript .NET languages so it’s intended for programmers only.</p> <p>All the scripts for a report must be written in the same language; this language is specified in the <em>Script Language</em> <a href="VFPS://Topic/_4KH0M6YTJ">report property</a>.</p> <p>To edit the scripts for a report, click the Scripts button (<img src="/assets/images/scriptsbutton.png" alt="" />) in the Report Designer toolbar.</p> <p><img src="/assets/images/scriptsbrowser.png" alt="" /></p> <p>The editor area shows the script code. This is a typical text editor but uses color coding to help with syntax. At the left edge is a strip to display line numbers. Small arrows appear to the right of the line numbers; clicking an arrow collapses or expands a code block.</p> <p>The Control drop-down list in the toolbar lists the objects in the report. The Event drop-down list beside the Control list displays the events for the selected object. Choosing one from the list either creates a script to handle that event or moves the editor to that script if it already exists.</p> <p>The Validate button in the toolbar examines the script code and displays any errors it finds as a red X in beside the line numbers at the left edge of the window. Hover your mouse pointer over the X to see the error message.</p> <p>The scripts for a report are organized like a typical .NET class but without the “class” definition. There may be using statements, fields, properties, and methods. Event handler methods are usually named <em>ObjectName</em>_<em>Event</em>, where <em>ObjectName</em> is the name of the object and <em>Event</em> is the event being handled for that object.</p> <p>If you created a script by selecting an event name from the list at the top, the script is automatically associated with that event for the object. However, you can also do that manually by expanding the Scripts property for an object and choosing the desired handler from the drop-down list for a specific event.</p> <p>Here’s an example where a script is useful: custom summarization. Suppose you want to show the total number of boxes of product units on order, where there are 15 items per box. Add a label to a group footer band of the report and set its data binding to the field containing the units on order. In the Properties Panel, set the Function sub-property of its Summary property to “Custom,” the Format String sub-property to “Total boxes: {0},” and the Running sub-property to “Group.” Expand the label’s Script property and click “…” for the Summary Reset, Summary Row Changed, and Summary Get Result events to create script code for them. Use code like the following for these scripts:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Declare a summary and a box.</span>
<span class="kt">double</span> <span class="n">totalUnits</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">box</span> <span class="p">=</span> <span class="m">15</span><span class="p">;</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">xrLabel1_SummaryReset</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span>
    <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Reset the result each time a group is printed.</span>
    <span class="n">totalUnits</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">xrLabel1_SummaryRowChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span>
    <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Calculate a summary.</span>
    <span class="n">totalUnits</span> <span class="p">+=</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToDouble</span><span class="p">(</span>
        <span class="nf">GetCurrentColumnValue</span><span class="p">(</span><span class="s">"UnitsOnOrder"</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">xrLabel1_SummaryGetResult</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span>
    <span class="n">SummaryGetResultEventArgs</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Round the result, so that a pack will be taken</span>
    <span class="c1">// into account even if it contains only one unit.</span>
    <span class="n">e</span><span class="p">.</span><span class="n">Result</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Ceiling</span><span class="p">(</span><span class="n">totalUnits</span> <span class="p">/</span> <span class="n">box</span><span class="p">);</span>
    <span class="n">e</span><span class="p">.</span><span class="n">Handled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div> <p>The SummaryReset method resets the total number of units to 0 when a group breaks. SummaryRowChanged fires on every record, so it adds the current value of the UnitsOnOrder field to the total. SummaryGetResult is called when the summary value is needed (that is, when the label is about to be printed); it calculates the number of boxes by dividing the total number of units by the units per box.</p> <!-- This was taken from https://documentation.devexpress.com/#XtraReports/CustomDocument4817. See also https://documentation.devexpress.com/#XtraReports/CustomDocument2615 and https://documentation.devexpress.com/#XtraReports/CustomDocument2617 --> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
